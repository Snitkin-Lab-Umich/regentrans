#run checks
check_pt_transfer_input(pt_trans_net, snv_dists, dists, locs, pt, thresh)
load_all()
document()
subset_pairs
document()
document()
document()
document()
load_all()
load_all()
#tests for patient transfer
#make a source destination pair test matrix
mat <- data.frame(matrix(data = c(0, 20, 30,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
pat_flow <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(pat_flow) <- c("source_facil", "dest_facil", "n_transfers")
pat_flow$n_transfers <- as.numeric(pat_flow$n_transfers)
pat_flow
test_locs <- locs[1:4]
test_pt <- as.character(pt[1:4])
names(test_pt) <- names(pt[1:4])
test_dists <- dists[names(test_locs), names(test_locs)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_locs <- locs[1:4]
test_pt <- as.character(pt[1:4])
names(test_pt) <- names(pt[1:4])
test_dists <- dists[names(test_locs), names(test_locs)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_locs <- locs[1:4]
test_pt <- as.character(pt[1:4])
names(test_pt) <- names(pt[1:4])
test_dists <- dists[names(test_locs), names(test_locs)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
load_all()
test_locs <- locs[1:4]
test_pt <- as.character(pt[1:4])
names(test_pt) <- names(pt[1:4])
test_dists <- dists[names(test_locs), names(test_locs)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
patient_transfer(pat_flow, test_snv_dists)
patient_transfer(pat_flow, test_snv_dists)
load_all()
patient_transfer(pat_flow, test_snv_dists)
test_locs
patient_transfer(pat_flow, test_snv_dists)
library(ape)
library(dplyr)
library(devtools)
library(phytools)
load_all()
mat <- data.frame(matrix(data = c(0, 20, 30,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
pat_flow <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(pat_flow) <- c("source_facil", "dest_facil", "n_transfers")
pat_flow$n_transfers <- as.numeric(pat_flow$n_transfers)
View(pat_flow)
thresh = 10
#run checks
check_pt_transfer_input(pt_trans_net, snv_dists, dists, locs, pt, thresh)
#run the function
snv_dists <- get_snv_dists(dists, locs, pt)
#run checks
check_pt_transfer_input(pt_trans_net, snv_dists, dists, locs, pt, thresh)
pt_trans_net <- pat_flow
#run checks
check_pt_transfer_input(pt_trans_net, snv_dists, dists, locs, pt, thresh)
load_all()
load_all()
#run checks
check_pt_transfer_input(pt_trans_net, snv_dists, dists, locs, pt, thresh)
#run checks
run_snv_dists <- check_pt_transfer_input(pt_trans_net = pt_trans_net, snv_dists = snv_dists,
dists = dists, locs = locs, pt = pt, thresh = thresh)
run_snv_dists
pat_flow <- dplyr::bind_cols(pt_trans_net %>% filter(source_facil != dest_facil))
pat_flow[1,3]
pat_flow[1,3] <- 12
pat_flow_1 <- pat_flow[!duplicated(t(apply(pat_flow, 1, sort))),]
View(pat_flow_1)
#make a list for apply
pat_flow <- split(pat_flow_1[,1:2], seq(nrow(pat_flow_1)))
pat_flow
#subset to one of each pair for snv_dists
snv_dists_sub <- subset_pairs(snv_dists)
pat_flow_summary <- data.frame(lapply(pat_flow, function(x){
#for each pair subset the snv_dists output to include only patients that came from those facilities
pair <- c(as.character(x[[1]]), as.character(x[[2]]))
#subset to only ones that are under the distance threshold
n <- snv_dists_sub %>% filter(as.character(Loc1) %in% pair,
as.character(Loc2) %in% pair,
Loc1 != Loc2,
as.numeric(Pairwise_Dists) <= thresh) %>%
nrow() %>% as.numeric()
return(n)
}))
View(pat_flow_summary)
x = 1
pair <- c(as.character(x[[1]]), as.character(x[[2]]))
pat_flow[[1]]
pat_flow[[1]][1]
pat_flow[[1]][2]
pat_flow[[1]][[2]
]
as.character(pat_flow[[1]][1])
as.character(pat_flow[[1]][[1]])
pat_flow
x <- pat_flow[[1]]
x
as.character(x[1])
as.character(x[[1]])
as.character(x[[2]])
#for each pair subset the snv_dists output to include only patients that came from those facilities
pair <- c(as.character(x[[1]]), as.character(x[[2]]))
#subset to only ones that are under the distance threshold
n <- snv_dists_sub %>% filter(as.character(Loc1) %in% pair,
as.character(Loc2) %in% pair,
Loc1 != Loc2,
as.numeric(Pairwise_Dists) <= thresh) %>%
nrow() %>% as.numeric()
n
thresh = 50
pat_flow_summary <- data.frame(lapply(pat_flow, function(x){
#for each pair subset the snv_dists output to include only patients that came from those facilities
pair <- c(as.character(x[[1]]), as.character(x[[2]]))
#subset to only ones that are under the distance threshold
n <- snv_dists_sub %>% filter(as.character(Loc1) %in% pair,
as.character(Loc2) %in% pair,
Loc1 != Loc2,
as.numeric(Pairwise_Dists) <= thresh) %>%
nrow() %>% as.numeric()
return(n)
}))
#add this info back to the list
df <- data.frame(matrix(unlist(pat_flow), nrow=length(pat_flow), byrow=TRUE)) %>% mutate(facil_1 = X1, facil_2 = X2, n_closely_related_pairs = t(pat_flow_summary)) %>% select(-1, -2) %>% left_join(pat_flow_1, by = c("facil_1" = "source_facil", "facil_2" = "dest_facil"))
View(df)
mat <- data.frame(matrix(data = c(0, 20, 30,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
pat_flow <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(pat_flow) <- c("source_facil", "dest_facil", "n_transfers")
pat_flow$n_transfers <- as.numeric(pat_flow$n_transfers)
test_locs <- locs[1:4]
test_pt <- as.character(pt[1:4])
names(test_pt) <- names(pt[1:4])
test_dists <- dists[names(test_locs), names(test_locs)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists)
mat <- data.frame(matrix(data = c(0, 20, 30,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
pat_flow <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(pat_flow) <- c("source_facil", "dest_facil", "n_transfers")
pat_flow$n_transfers <- as.numeric(pat_flow$n_transfers)
test_locs <- locs[1:4]
test_pt <- as.character(pt[1:4])
names(test_pt) <- names(pt[1:4])
test_dists <- dists[names(test_locs), names(test_locs)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists)
length(intersect(unique(c(as.character(pt_trans_net$source_facil), as.character(pt_trans_net$dest_facil)))
unique(c(as.character(pt_trans_net$source_facil), as.character(pt_trans_net$dest_facil)))
unique(locs)
test_locs
length(intersect(unique(c(as.character(pt_trans_net$source_facil), as.character(pt_trans_net$dest_facil))), unique(test_locs)))
length(intersect(unique(c(as.character(pt_trans_net$source_facil), as.character(pt_trans_net$dest_facil))), unique(test_locs))) <2
load_all()
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists)
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists)
View(test_dists)
View(test_snv_dists)
c(snv_dists$Loc1, snv_dists$Loc2)
load_all()
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists)
#subset to only facilities in the locs object
common_locs <- intersect(unique(c(snv_dists$Loc1, snv_dists$Loc2)), unique(c(pt_trans_net$source_facil, pt_trans_net$dest_facil)))
common_locs
unique(c(snv_dists$Loc1, snv_dists$Loc2))
unique(c(pt_trans_net$source_facil, pt_trans_net$dest_facil))
pt_trans_net$source_facil
pt_trans_net$source_facil <- as.factor(pt_trans_net$source_facil)
pt_trans_net$dest_facil <- as.factor(pt_trans_net$dest_facil)
#subset to only facilities in the locs object
common_locs <- intersect(unique(c(snv_dists$Loc1, snv_dists$Loc2)), unique(c(pt_trans_net$source_facil, pt_trans_net$dest_facil)))
common_locs
pt_trans_net$source_facil
#make pt_trans_net not factors
pt_trans_net$source_facil <- as.character(pt_trans_net$source_facil)
pt_trans_net$dest_facil <- as.character(pt_trans_net$dest_facil)
#subset to only facilities in the locs object
common_locs <- intersect(unique(c(snv_dists$Loc1, snv_dists$Loc2)), unique(c(pt_trans_net$source_facil, pt_trans_net$dest_facil)))
common_locs
#subset to only facilities in the locs object
common_locs <- intersect(unique(c(snv_dists$Loc1, snv_dists$Loc2)), unique(c(pt_trans_net$source_facil, pt_trans_net$dest_facil)))
pt_trans_net_sub <- pt_trans_net %>% filter(source_facil %in% common_locs,
dest_facil %in% common_locs)
pt_trans_net_sub
snv_dists_sub <- snv_dists %>% filter(Loc1 %in% common_locs,
Loc2 %in% common_locs)
snv_dists_sub
load_all()
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists)
View(test_pt_trans)
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists, thresh = 50)
mat <- data.frame(matrix(data = c(0, 20, 12,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
pat_flow <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(pat_flow) <- c("source_facil", "dest_facil", "n_transfers")
pat_flow$n_transfers <- as.numeric(pat_flow$n_transfers)
test_locs <- locs[1:4]
test_pt <- as.character(pt[1:4])
names(test_pt) <- names(pt[1:4])
test_dists <- dists[names(test_locs), names(test_locs)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists, thresh = 50)
pt_trans_net <- pat_flow
snv_dists <- test_snv_dists
dists = NULL
locs = NULL
pt = NULL
thresh = 50
#run checks
run_snv_dists <- check_pt_transfer_input(pt_trans_net = pt_trans_net, snv_dists = snv_dists,
dists = dists, locs = locs, pt = pt, thresh = thresh)
run_snv_dists
#make pt_trans_net not factors
pt_trans_net$source_facil <- as.character(pt_trans_net$source_facil)
pt_trans_net$dest_facil <- as.character(pt_trans_net$dest_facil)
#run get_snv_dists if necessary
if(run_snv_dists){
cat("Running get_snv_dists...")
snv_dists <- get_snv_dists(dists = dists, locs = locs, pt = pt)
}
#subset to only facilities in the locs object
common_locs <- intersect(unique(c(snv_dists$Loc1, snv_dists$Loc2)), unique(c(pt_trans_net$source_facil, pt_trans_net$dest_facil)))
common_locs
pt_trans_net <- pt_trans_net %>% filter(source_facil %in% common_locs,
dest_facil %in% common_locs)
pt_trans_net
snv_dists <- snv_dists %>% filter(Loc1 %in% common_locs,
Loc2 %in% common_locs)
snv_dists
#remove any same-facility pairs
pat_flow <- dplyr::bind_cols(pt_trans_net %>% filter(source_facil != dest_facil))
pat_flow
#remove any duplicate info
pat_flow_1 <- pat_flow[!duplicated(t(apply(pat_flow, 1, sort))),]
pat_flow_1
#make a list for apply
pat_flow <- split(pat_flow_1[,1:2], seq(nrow(pat_flow_1)))
pat_flow
#subset to one of each pair for snv_dists
snv_dists_sub <- subset_pairs(snv_dists)
snv_dists_sub
pat_flow_summary <- data.frame(lapply(pat_flow, function(x){
#for each pair subset the snv_dists output to include only patients that came from those facilities
pair <- c(as.character(x[[1]]), as.character(x[[2]]))
#subset to only ones that are under the distance threshold
n <- snv_dists_sub %>% filter(as.character(Loc1) %in% pair,
as.character(Loc2) %in% pair,
Loc1 != Loc2,
as.numeric(Pairwise_Dists) <= thresh) %>%
nrow() %>% as.numeric()
return(n)
}))
pat_flow_summary
x <- pat_flow[[1]]
x
#for each pair subset the snv_dists output to include only patients that came from those facilities
pair <- c(as.character(x[[1]]), as.character(x[[2]]))
pair
#subset to only ones that are under the distance threshold
n <- snv_dists_sub %>% filter(as.character(Loc1) %in% pair,
as.character(Loc2) %in% pair,
Loc1 != Loc2,
as.numeric(Pairwise_Dists) <= thresh) %>%
nrow() %>% as.numeric()
n
snv_dists_sub %>% filter(as.character(Loc1) %in% pair,
as.character(Loc2) %in% pair,
Loc1 != Loc2,
as.numeric(Pairwise_Dists) <= thresh)
ncol(test_pt_trans) == 4
colnames(test_pt_trans)
all(colnames(test_pt_trans) == c("facil_1", "facil_2", "n_closely_related_pairs", "n_transfers"))
sapply(test_pt_trans, class)
apply(test_pt_trans, class)
sapply(test_pt_trans, class)
load_all()
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists, thresh = 50)
mat <- data.frame(matrix(data = c(0, 20, 12,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
pat_flow <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(pat_flow) <- c("source_facil", "dest_facil", "n_transfers")
pat_flow$n_transfers <- as.numeric(pat_flow$n_transfers)
test_locs <- locs[1:4]
test_pt <- as.character(pt[1:4])
names(test_pt) <- names(pt[1:4])
test_dists <- dists[names(test_locs), names(test_locs)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_pt_trans <- patient_transfer(pat_flow, test_snv_dists, thresh = 50)
all(sapply(test_pt_trans, class)
hsh
sapply(test_pt_trans, class)
all(sapply(test_pt_trans, class) == c("character", "character", "numeric", "numeric"))
View(pat_flow)
nrow(test_pt_trans) <= nrow(pat_flow)
mat <- data.frame(matrix(data = c(0, 20, 12,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
pat_flow <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(pat_flow) <- c("source_facil", "dest_facil", "n_transfers")
pat_flow$n_transfers <- as.numeric(pat_flow$n_transfers)
test_locs <- locs[1:4]
test_locs_2 <- locs[5:8]
test_locs_3 <- locs[1:3]
test_locs_4 <- locs[1]
test_locs_5 <- locs[locs %in% c("A", "F", "H")]
test_locs_6 <- locs[1:4]
test_locs_7 <- test_locs_5[1:4]
test_locs_8 <- test_locs_5[2:6]
test_locs_9 <- test_locs_5[1:6]
test_pt <- pt[1:4]
test_pt_2 <- pt[5:8]
test_pt_3 <- pt[1:3]
test_dists <- dists[names(test_locs), names(test_locs)]
test_dists_2 <- dists[names(test_locs_3), names(test_locs_3)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_snv_dists_2 <- test_snv_dists[,2:ncol(test_snv_dists)]
test_snv_dists_3 <- test_snv_dists
colnames(test_snv_dists_3) <- c("A", "B", "C", "D", "E", "F", "G", "H")
test_snv_dists_4 <- test_snv_dists
test_snv_dists_4$Pairwise_Dists <- as.character(test_snv_dists_4$Pairwise_Dists)
test_tr <- keep.tip(tr,names(test_pt))
test_tr_2 <- keep.tip(tr,names(test_pt_3))
test_fasta <- fasta[names(test_locs),]
test_fasta_2 <- fasta[names(test_locs_5),]
test_fasta_3 <- fasta[names(test_locs_9),]
ls <- list(list(a = 2, b = 3), list(c = "a", d = "b"))
ls_2 <- list(list(a = 2, b = 3), list(c = "a", d = "b"), "x")
test_subtr <- ape::subtrees(test_tr)
test_subtr_2 <- ape::subtrees(test_tr_2)
mat <- data.frame(matrix(data = c(0, 20, 12,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
pat_flow <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(pat_flow) <- c("source_facil", "dest_facil", "n_transfers")
pat_flow$n_transfers <- as.numeric(pat_flow$n_transfers)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = test_snv_dists, threshs = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
test_pt_trans_net <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(test_pt_trans_net) <- c("source_facil", "dest_facil", "n_transfers")
test_pt_trans_net$n_transfers <- as.numeric(test_pt_trans_net$n_transfers)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = NULL, thresh = 50, dists = test_dists, locs = test_locs, pt = test_pt)
test_dists
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = NULL, thresh = 50, dists = test_snv_dists, locs = test_locs, pt = test_pt)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = NULL, thresh = 50, dists = test_snv_dists, locs = test_locs, pt = test_pt)
class(dists)
load_all()
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = NULL, thresh = 50, dists = test_snv_dists, locs = test_locs, pt = test_pt)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = NULL, thresh = 50, dists = test_dists, locs = test_locs, pt = test_pt)
test_locs <- locs[1:4]
test_locs_2 <- locs[5:8]
test_locs_3 <- locs[1:3]
test_locs_4 <- locs[1]
test_locs_5 <- locs[locs %in% c("A", "F", "H")]
test_locs_6 <- locs[1:4]
test_locs_7 <- test_locs_5[1:4]
test_locs_8 <- test_locs_5[2:6]
test_locs_9 <- test_locs_5[1:6]
test_pt <- pt[1:4]
test_pt_2 <- pt[5:8]
test_pt_3 <- pt[1:3]
test_dists <- dists[names(test_locs), names(test_locs)]
test_dists_2 <- dists[names(test_locs_3), names(test_locs_3)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_snv_dists_2 <- test_snv_dists[,2:ncol(test_snv_dists)]
test_snv_dists_3 <- test_snv_dists
colnames(test_snv_dists_3) <- c("A", "B", "C", "D", "E", "F", "G", "H")
test_snv_dists_4 <- test_snv_dists
test_snv_dists_4$Pairwise_Dists <- as.character(test_snv_dists_4$Pairwise_Dists)
test_tr <- keep.tip(tr,names(test_pt))
test_tr_2 <- keep.tip(tr,names(test_pt_3))
test_fasta <- fasta[names(test_locs),]
test_fasta_2 <- fasta[names(test_locs_5),]
test_fasta_3 <- fasta[names(test_locs_9),]
ls <- list(list(a = 2, b = 3), list(c = "a", d = "b"))
ls_2 <- list(list(a = 2, b = 3), list(c = "a", d = "b"), "x")
test_subtr <- ape::subtrees(test_tr)
test_subtr_2 <- ape::subtrees(test_tr_2)
mat <- data.frame(matrix(data = c(0, 20, 12,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
test_pt_trans_net <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(test_pt_trans_net) <- c("source_facil", "dest_facil", "n_transfers")
test_pt_trans_net$n_transfers <- as.numeric(test_pt_trans_net$n_transfers)
test_dists
dists
regentrans::dists
dists
load_all()
test_locs <- locs[1:4]
test_locs_2 <- locs[5:8]
test_locs_3 <- locs[1:3]
test_locs_4 <- locs[1]
test_locs_5 <- locs[locs %in% c("A", "F", "H")]
test_locs_6 <- locs[1:4]
test_locs_7 <- test_locs_5[1:4]
test_locs_8 <- test_locs_5[2:6]
test_locs_9 <- test_locs_5[1:6]
test_pt <- pt[1:4]
test_pt_2 <- pt[5:8]
test_pt_3 <- pt[1:3]
test_dists <- dists[names(test_locs), names(test_locs)]
test_dists_2 <- dists[names(test_locs_3), names(test_locs_3)]
test_snv_dists <- get_snv_dists(dists = test_dists, locs = test_locs, pt = test_pt)
test_snv_dists_2 <- test_snv_dists[,2:ncol(test_snv_dists)]
test_snv_dists_3 <- test_snv_dists
colnames(test_snv_dists_3) <- c("A", "B", "C", "D", "E", "F", "G", "H")
test_snv_dists_4 <- test_snv_dists
test_snv_dists_4$Pairwise_Dists <- as.character(test_snv_dists_4$Pairwise_Dists)
test_tr <- keep.tip(tr,names(test_pt))
test_tr_2 <- keep.tip(tr,names(test_pt_3))
test_fasta <- fasta[names(test_locs),]
test_fasta_2 <- fasta[names(test_locs_5),]
test_fasta_3 <- fasta[names(test_locs_9),]
ls <- list(list(a = 2, b = 3), list(c = "a", d = "b"))
ls_2 <- list(list(a = 2, b = 3), list(c = "a", d = "b"), "x")
test_subtr <- ape::subtrees(test_tr)
test_subtr_2 <- ape::subtrees(test_tr_2)
mat <- data.frame(matrix(data = c(0, 20, 12,
20, 0, 26,
30, 26, 0), nrow = 3, ncol = 3))
rownames(mat) <- c("A", "B", "C")
colnames(mat) <- c("A", "B", "C")
test_pt_trans_net <- na.omit(data.frame(as.table(as.matrix(mat))))
#pat_flow <- dplyr::bind_cols(pat_flow %>% filter(Var1 != Var2))
colnames(test_pt_trans_net) <- c("source_facil", "dest_facil", "n_transfers")
test_pt_trans_net$n_transfers <- as.numeric(test_pt_trans_net$n_transfers)
test_dists
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = NULL, thresh = 50, dists = test_dists, locs = test_locs, pt = test_pt)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = "test_snv_dists", thresh = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = test_snv_dists[,2:ncol(test_snv_dists)], thresh = 50, dists = NULL, locs = NULL, pt = NULL)
test_snv_dists_3
test_snv_dists_2
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = test_snv_dists_2, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = test_snv_dists_3, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
test_snv_dists_4
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = test_snv_dists_4, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = NULL, thresh = 50, dists = "test_dists", locs = test_locs, pt = test_pt)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net, snv_dists = test_snv_dists, thresh = -1, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = "test_pt_trans_net", snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net[,2:ncol(test_pt_trans_net)], snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
pt_trans_net_3 <- test_pt_trans_net
pt_trans_net_2 <- test_pt_trans_net[,2:ncol(test_pt_trans_net)]
colnames(pt_trans_net_3) <- c("A", "B", "C")
pt_trans_net_4 <- test_pt_trans_net
pt_trans_net_2 <- test_pt_trans_net[,2:ncol(test_pt_trans_net)]
pt_trans_net_3 <- test_pt_trans_net
colnames(pt_trans_net_3) <- c("A", "B", "C")
pt_trans_net_4 <- test_pt_trans_net
pt_trans_net_4$n_transfers <- as.character(pt_trans_net_4$n_transfers)
expect_error(
check_pt_transfer_input(pt_trans_net = test_pt_trans_net_2, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
fifj
check_pt_transfer_input(pt_trans_net = test_pt_trans_net_2, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
test_pt_trans_net_2 <- test_pt_trans_net[,2:ncol(test_pt_trans_net)]
test_pt_trans_net_3 <- test_pt_trans_net
colnames(test_pt_trans_net_3) <- c("A", "B", "C")
test_pt_trans_net_4 <- test_pt_trans_net
test_pt_trans_net_4$n_transfers <- as.character(test_pt_trans_net_4$n_transfers)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net_2, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net_3, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
load_all()
check_pt_transfer_input(pt_trans_net = test_pt_trans_net_3, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net_3, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
check_pt_transfer_input(pt_trans_net = test_pt_trans_net_4, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
load_all()
check_pt_transfer_input(pt_trans_net = test_pt_trans_net_4, snv_dists = test_snv_dists, thresh = 50, dists = NULL, locs = NULL, pt = NULL)
